TRUNCATE TABLE sfpd;

COPY sfpd(IncidntNum,Category,Description,DayOfWeek,DateTime,Time,PdDistrict,Resolution,Location,X,Y)
 FROM LOCAL '/Users/tomaskorcak/dev/bootcamp/data/sfpd_incident_2003.csv'
 DELIMITER ','
 ENCLOSED BY '"'
 SKIP 1
 ABORT ON ERROR
 DIRECT;

COPY sfpd(IncidntNum,Category,Description,DayOfWeek,DateTime,Time,PdDistrict,Resolution,Location,X,Y)
 FROM LOCAL '/Users/tomaskorcak/dev/bootcamp/data/sfpd_incident_2004.csv'
 DELIMITER ','
 ENCLOSED BY '"'
 SKIP 1
 ABORT ON ERROR
 DIRECT;

COPY sfpd(IncidntNum,Category,Description,DayOfWeek,DateTime,Time,PdDistrict,Resolution,Location,X,Y)
 FROM LOCAL '/Users/tomaskorcak/dev/bootcamp/data/sfpd_incident_2005.csv'
 DELIMITER ','
 ENCLOSED BY '"'
 SKIP 1
 ABORT ON ERROR
 DIRECT;

COPY sfpd(IncidntNum,Category,Description,DayOfWeek,DateTime,Time,PdDistrict,Resolution,Location,X,Y)
 FROM LOCAL '/Users/tomaskorcak/dev/bootcamp/data/sfpd_incident_2006.csv'
 DELIMITER ','
 ENCLOSED BY '"'
 SKIP 1
 ABORT ON ERROR
 DIRECT;

COPY sfpd(IncidntNum,Category,Description,DayOfWeek,DateTime,Time,PdDistrict,Resolution,Location,X,Y)
 FROM LOCAL '/Users/tomaskorcak/dev/bootcamp/data/sfpd_incident_2007.csv'
 DELIMITER ','
 ENCLOSED BY '"'
 SKIP 1
 ABORT ON ERROR
 DIRECT;

COPY sfpd(IncidntNum,Category,Description,DayOfWeek,DateTime,Time,PdDistrict,Resolution,Location,X,Y)
 FROM LOCAL '/Users/tomaskorcak/dev/bootcamp/data/sfpd_incident_2008.csv'
 DELIMITER ','
 ENCLOSED BY '"'
 SKIP 1
 ABORT ON ERROR
 DIRECT;

COPY sfpd(IncidntNum,Category,Description,DayOfWeek,DateTime,Time,PdDistrict,Resolution,Location,X,Y)
 FROM LOCAL '/Users/tomaskorcak/dev/bootcamp/data/sfpd_incident_2009.csv'
 DELIMITER ','
 ENCLOSED BY '"'
 SKIP 1
 ABORT ON ERROR
 DIRECT;

 COPY sfpd(IncidntNum,Category,Description,DayOfWeek,DateTime,Time,PdDistrict,Resolution,Location,X,Y)
 FROM LOCAL '/Users/tomaskorcak/dev/bootcamp/data/sfpd_incident_2010.csv'
 DELIMITER ','
 ENCLOSED BY '"'
 SKIP 1
 ABORT ON ERROR
 DIRECT;

 COPY sfpd(IncidntNum,Category,Description,DayOfWeek,DateTime,Time,PdDistrict,Resolution,Location,X,Y)
 FROM LOCAL '/Users/tomaskorcak/dev/bootcamp/data/sfpd_incident_2011.csv'
 DELIMITER ','
 ENCLOSED BY '"'
 SKIP 1
 ABORT ON ERROR
 DIRECT;

 COPY sfpd(IncidntNum,Category,Description,DayOfWeek,DateTime,Time,PdDistrict,Resolution,Location,X,Y)
 FROM LOCAL '/Users/tomaskorcak/dev/bootcamp/data/sfpd_incident_2012.csv'
 DELIMITER ','
 ENCLOSED BY '"'
 SKIP 1
 ABORT ON ERROR
 DIRECT;

 COPY sfpd(IncidntNum,Category,Description,DayOfWeek,DateTime,Time,PdDistrict,Resolution,Location,X,Y)
 FROM LOCAL '/Users/tomaskorcak/dev/bootcamp/data/sfpd_incident_2013.csv'
 DELIMITER ','
 ENCLOSED BY '"'
 SKIP 1
 ABORT ON ERROR
 DIRECT;

 COPY sfpd(IncidntNum,Category,Description,DayOfWeek,DateTime,Time,PdDistrict,Resolution,Location,X,Y)
 FROM LOCAL '/Users/tomaskorcak/dev/bootcamp/data/sfpd_incident_2014.csv'
 DELIMITER ','
 ENCLOSED BY '"'
 SKIP 1
 ABORT ON ERROR
 DIRECT;

SELECT COUNT(*) from sfpd;

-- DROP TABLE sfpd_out;
-- TRUNCATE TABLE sfpd_out;

SELECT *, CONCAT(CONCAT(LEFT(y, INSTR(y, '.') + 7), ';'), LEFT(x, INSTR(x, '.') + 7)) as XY, 1 as dummy INTO sfpd_out from sfpd; 

SELECT COUNT(*) from sfpd_out;